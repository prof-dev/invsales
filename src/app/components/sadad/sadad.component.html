<mat-card>
  <mat-card-header>
    <mat-card-title>علمية السداد والدفعيات</mat-card-title>
  </mat-card-header>
  <h3></h3>
  <mat-card-content>
    <button mat-raised-button color="primary" (click)="forsuppliers()">الدفع للموردين </button>&nbsp;
    <button mat-raised-button color="primary" (click)="fromcustomers()"> إستلام دفعيات العملاء</button>
    <br>

    <mat-form-field *ngIf="processinfo.status=='c'">
      <mat-select placeholder="إختيار العميل" [(ngModel)]="supcus" (change)="selected($event.value)">
        <mat-option>None</mat-option>
        <mat-option *ngFor="let op of cuss" [value]="op">{{op.namear}}</mat-option>
      </mat-select>
    </mat-form-field>
    <mat-form-field *ngIf="processinfo.status=='s'">
      <mat-select placeholder="إختيار المورد" [(ngModel)]="supcus" (change)="selected($event.value)">
        <mat-option>None</mat-option>
        <mat-option *ngFor="let op of supp" [value]="op">{{op.namear}}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <input matInput required placeholder=" اسم العميل" [(ngModel)]="supcus.namear" [disabled]="true">
    </mat-form-field>
    <mat-form-field>
      <input matInput required placeholder=" رصيد العميل" [(ngModel)]="supcus.amount" [disabled]="true">
    </mat-form-field>
<!-- 
    <mat-form-field>
      <input matInput required placeholder=" تلفون العميل" [(ngModel)]="supcus.data.phone" [disabled]="true">
    </mat-form-field> -->
    <br>

    <mat-form-field>
      <textarea matInput required placeholder="التعليق " name="paid" [(ngModel)]="sadad.desc" required></textarea>
    </mat-form-field>
    <br>
    <h3> الدفع</h3>
    <mat-form-field>
      <select matNativeControl required class="primary" [(ngModel)]="payment.paymentmethod" placeholder="طريقة الدفع">
        <option *ngFor="let ch of paymentmethods" [(value)]="ch.value">{{ch.viewValue}} </option>

      </select>
    </mat-form-field>
    <mat-form-field>
      <input matInput required placeholder=" المدفوع" name="total" [(ngModel)]="paid" required>
    </mat-form-field>


    <div *ngIf="payment.paymentmethod=='check'">
      <mat-form-field>
        <input matInput required placeholder="قيمة الشيك " name="paid" [(ngModel)]="payment.amount" required>
      </mat-form-field>
      <mat-form-field>
        <input matInput required placeholder="رقم الشيك" name="reminder" [(ngModel)]="payment.checkno" required>
      </mat-form-field>
      <mat-form-field>
        <input matInput required placeholder="اسم البنك " name="paid" [(ngModel)]="payment.bankname" required>
      </mat-form-field>
      <mat-form-field>
          <input matInput [matDatepicker]="date" placeholder=" تاريخ الشيك" [(ngModel)]="payment.date">
          <mat-datepicker-toggle matSuffix [for]="date"></mat-datepicker-toggle>
          <mat-datepicker #date></mat-datepicker>
        </mat-form-field>
      <mat-form-field>
        <input matInput required placeholder="حساب بإسم " name="reminder" [(ngModel)]="payment.checkowner" required>
      </mat-form-field>
      <mat-form-field>
        <select matNativeControl required class="primary" [(ngModel)]="payment.checkstatus" placeholder=" حالة الشيك"
          (focusout)="pushpayment(payment)">
          <option *ngFor="let ch of checkstatus" [(value)]="ch.value">{{ch.viewValue}} </option>

        </select>
      </mat-form-field>
    </div>

    <div *ngIf="payment.paymentmethod=='cash'">
      <mat-form-field>
        <input matInput required placeholder="المدفوع " name="paid" [(ngModel)]="payment.amount" required (focusout)="pushpayment(payment)">
      </mat-form-field>

    </div>
    <!-- <button mat-raised-button (click)="addpayment(payment)">
      <img src="assets/icnAdd.png" alt="" width="32" class="btn-img">
    </button> -->

    <div>
      <h4>ملخص الدفع</h4>
      <table>
        <tr>
          <th>
            الملبلغ
          </th>
          <th>
            طريقة الدفع
          </th>
          <th>
            رقم الشيك
          </th>

          <th>
            العمليات
          </th>
        </tr>
        <tr *ngFor="let row of payments;let i=index;">
          <td>{{row.amount}}</td>
          <td>{{row.paymentmethod}}</td>
          <td>{{row.checkno}}</td>
          <td>
            <img src="assets/icnEdit.png" alt="" width="32" class="btn-img" (click)="editPayment(row)">
            <img src="assets/icnDelete.png" alt="" width="32" class="btn-img" (click)="deletePayment(index,row)">
          </td>
        </tr>
      </table>

    </div>

    <button mat-raised-button (click)="save()" n *ngIf="sadad.id==null" >
      <img src="assets/icnSave.png" alt="" width="32" class="btn-img">
    </button>
    <button *ngIf="sadad.id!=null" mat-raised-button (click)="print(payment)">
      طباعة ايصال
    </button>


    <div class="printdiv" hidden="true">
      <table>
        <tr>
          <td>
            رقم المعاملة: {{sadad.id}}
          </td>
        </tr>
        <tr>
          <td>
            إسم العميل/المورد : {{supcus.namear}}
          </td>
        </tr>
        <tr>
          <td>
            جملة المدفوع او المستلم : {{paid}}
          </td>
        </tr>
        <tr>
          <table>
            <thead>
                <tr>
                    <th>
                      طريقة الدفع
                    </th>
                    <th>
                      رقم الشيك
                    </th>
                    <th>
                      الملبلغ
                    </th>
      
                  </tr>
            </thead>
           <tbody>
              <tr *ngFor="let row of payments;let i=index;">
                  <td>{{row.paymentmethod}}</td>
                  <td>{{row.checkno}}</td>
                  <td>{{row.amount}}</td>
    
    
    
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td>
                    جملة المدفوع او المستلم : {{paid}}
                  </td>
                </tr>
              </table>
            </tr>
    
    
           </tbody>
      
      </table>
    </div>


  </mat-card-content>
</mat-card>